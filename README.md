# üöÄ AI Background Remover (RemBG Pipeline)

–ú–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è —Ñ–æ–Ω–∞ —Å **–∫–∞—Ä—Ç–∏–Ω–æ–∫** –∏ **–≤–∏–¥–µ–æ**.
–ù–∞–ø–∏—Å–∞–Ω –Ω–∞ Python, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ (U2Net) –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É —á–µ—Ä–µ–∑ FFmpeg.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üçè –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–¥ Apple Silicon (CoreML, Neural Engine)
- üñº –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–æ–Ω–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- üé• –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ (mp4, webm, gif)
- üîä –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π –∞—É–¥–∏–æ–¥–æ—Ä–æ–∂–∫–∏
- üìÅ –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–ø–æ–∫ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- üõ° –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ –∏—Å—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

---

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. FFmpeg (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)

**macOS**
```bash
brew install ffmpeg
```

**Windows**
–°–∫–∞—á–∞–π—Ç–µ —Å —Å–∞–π—Ç–∞ ffmpeg.org –∏ –¥–æ–±–∞–≤—å—Ç–µ –ø—É—Ç—å –∫ bin –≤ PATH

**Linux**
```bash
sudo apt install ffmpeg
```

---

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**
- Python 3.9+ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 3.10+)
- FFmpeg —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ `PATH`

```bash
git clone https://github.com/DaemoncheG/bgremover.git
cd bgremover
```

–°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```bash
# macOS / Linux
python3 -m venv venv
source venv/bin/activate

# Windows
python -m venv venv
venv\Scripts\activate
```

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:

```bash
pip install -r requirements.txt
```

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

**–î–æ / –ü–æ—Å–ª–µ**
- –í—Ö–æ–¥: `input.jpg`
- –í—ã—Ö–æ–¥: `output.png` (–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω)

### –ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤ (–∫–∞—Ä—Ç–∏–Ω–∫–∏)

**1) –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –≤–∞—Ä–∏–∞–Ω—Ç**
```bash
# –í—Ö–æ–¥–Ω–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞ -> –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π PNG
python main.py input.jpg output.png
```

**2) –Ø–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å –º–æ–¥–µ–ª—å**
```bash
python main.py input.jpg output.png --model u2net
```

**3) –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ JPG (—Ñ–æ–Ω —Å—Ç–∞–Ω–µ—Ç –±–µ–ª—ã–º)**
```bash
python main.py input.png output.jpg
```

**4) –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ WebP**
```bash
python main.py input.jpg output.webp
```

**5) –ü–∞–ø–∫–∞ —Ü–µ–ª–∏–∫–æ–º (–≤—Å–µ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –≤–Ω—É—Ç—Ä–∏)**
```bash
# –í—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ –ø–∞–ø–∫–∏ input/ –ø–æ–ø–∞–¥—É—Ç –≤ output/ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
python main.py input/ output/
```

**6) –ü–∞–ø–∫–∞ —Å —Ç–æ—á–∫–æ–π –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–ª—ç—à –≤ –∫–æ–Ω—Ü–µ)**
```bash
# –ï—Å–ª–∏ —É –ø–∞–ø–∫–∏ –µ—Å—Ç—å —Ç–æ—á–∫–∞, –¥–æ–±–∞–≤—å—Ç–µ —Å–ª—ç—à, —á—Ç–æ–±—ã –Ω–µ —Å–ø—É—Ç–∞—Ç—å —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º
python main.py photos.v1/ out/
```

**7) –ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã –≤—ã—Ö–æ–¥ –±—ã–ª –≤—Å–µ–≥–¥–∞ PNG**
```bash
python main.py input.jpg output.png --img-format png
```

### –ö–∞—Ä—Ç–∏–Ω–∫–∞

```bash
python main.py input.jpg output.png
```

### –í–∏–¥–µ–æ MP4 —Å —Ü–≤–µ—Ç–Ω—ã–º —Ñ–æ–Ω–æ–º

```bash
python main.py video.mp4 result.mp4 --bg-color green
```

### –í–∏–¥–µ–æ WebM —Å –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å—é

```bash
python main.py video.mp4 result.webm
```

### –ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤ (–≤–∏–¥–µ–æ)

**1) –ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**
```bash
# –õ—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏ ‚Äî WebM
python main.py video.mp4 result.webm
```

**2) MP4 —Å –∑–∞–¥–∞–Ω–Ω—ã–º —Ñ–æ–Ω–æ–º**
```bash
python main.py video.mp4 result.mp4 --bg-color black
```

**3) MP4 —Å –∑–µ–ª–µ–Ω—ã–º —Ñ–æ–Ω–æ–º (–¥–ª—è —Ö—Ä–æ–º–∞–∫–µ—è)**
```bash
python main.py video.mp4 result.mp4 --bg-color green
```

**4) GIF**
```bash
python main.py video.mp4 result.gif
```

**5) –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–ø–∫–∏ —Å –≤–∏–¥–µ–æ**
```bash
python main.py videos/ out_videos/
```

**6) –£—Å–∫–æ—Ä–µ–Ω–∏–µ (–¥–ª—è macOS Apple Silicon)**
```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CoreML (–æ–±—ã—á–Ω–æ –±—ã—Å—Ç—Ä–µ–µ)
python main.py video.mp4 result.webm --coreml 2
```

**7) –£—Å–∫–æ—Ä–µ–Ω–∏–µ (CPU, Windows/Linux)**
```bash
python main.py video.mp4 result.webm --cpu 2
```

### –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–ø–∫–∏

```bash
python main.py input_folder output_folder
```

---

## ‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

- `--model` –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏  
  - u2net (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
  - u2netp
  - u2net_human_seg
  - u2net_cloth_seg
  - silueta
  - isnet-general-use
  - isnet-anime
  - sam
  - birefnet-general
  - birefnet-general-lite
  - birefnet-portrait
  - birefnet-dis
  - birefnet-hrsod
  - birefnet-cod
  - birefnet-massive
  - bria-rmbg

- `--bg-color` —Ü–≤–µ—Ç —Ñ–æ–Ω–∞ (black, white, green, blue)
- `--coreml` —á–∏—Å–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ CoreML (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 2 –Ω–∞ Apple Silicon)
  - –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è: 1‚Äì4
- `--cpu` —á–∏—Å–ª–æ CPU –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 2 –Ω–∞ Windows/Linux)
  - –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è: 1‚Äì4

–°–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π:

```bash
python main.py --list-models
```

### –ö–æ–≥–¥–∞ –∫–∞–∫—É—é –º–æ–¥–µ–ª—å –≤—ã–±–∏—Ä–∞—Ç—å

- **u2net** ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å—Ü–µ–Ω –∏ –ø—Ä–µ–¥–º–µ—Ç–æ–≤.
- **u2netp** ‚Äî –ª–µ–≥–∫–∞—è –∏ –±—ã—Å—Ç—Ä–∞—è, –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–ª–∞–±—ã—Ö CPU –∏ –ø–∞–∫–µ—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.
- **u2net_human_seg** ‚Äî —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è —á–µ–ª–æ–≤–µ–∫–∞, —Ö–æ—Ä–æ—à–∏–π –≤—ã–±–æ—Ä –¥–ª—è –ø–æ—Ä—Ç—Ä–µ—Ç–æ–≤ –∏ –ª—é–¥–µ–π –≤ –∫–∞–¥—Ä–µ.
- **u2net_cloth_seg** ‚Äî –≤—ã–¥–µ–ª–µ–Ω–∏–µ –æ–¥–µ–∂–¥—ã (–≤–µ—Ä—Ö/–Ω–∏–∑/–ø–æ–ª–Ω—ã–π –æ–±—Ä–∞–∑), –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è fashion-–∫–∞—Ç–∞–ª–æ–≥–æ–≤.
- **silueta** ‚Äî —É–º–µ–Ω—å—à–µ–Ω–Ω—ã–π u2net, –∫–æ–º–ø—Ä–æ–º–∏—Å—Å —Å–∫–æ—Ä–æ—Å—Ç—å/–∫–∞—á–µ—Å—Ç–≤–æ –¥–ª—è –º–∞—Å—Å–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.
- **isnet-general-use** ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å —Å —Ö–æ—Ä–æ—à–∏–º–∏ –∫–æ–Ω—Ç—É—Ä–∞–º–∏ –æ–±—ä–µ–∫—Ç–æ–≤.
- **isnet-anime** ‚Äî —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –ø–æ–¥ –∞–Ω–∏–º–µ/–∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏–∏.
- **sam** ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è, –ª—É—á—à–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —á–µ—Ç–∫–∏–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏; –¥–ª—è —Ç–æ—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –æ–±—ã—á–Ω–æ –Ω—É–∂–Ω—ã –ø—Ä–æ–º–ø—Ç—ã (–≤ —ç—Ç–æ–π —É—Ç–∏–ª–∏—Ç–µ –ø—Ä–æ–º–ø—Ç—ã –Ω–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è).
- **birefnet-general** ‚Äî —Å–∏–ª—å–Ω–∞—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –≥—Ä–∞–Ω–∏—Ü –∏ –¥–µ—Ç–∞–ª–µ–π.
- **birefnet-general-lite** ‚Äî –æ–±–ª–µ–≥—á–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è birefnet-general –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è.
- **birefnet-portrait** ‚Äî –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –ø–æ—Ä—Ç—Ä–µ—Ç–æ–≤ –∏ –ª—é–¥–µ–π.
- **birefnet-dis** ‚Äî –¥–ª—è –∑–∞–¥–∞—á –±–∏–Ω–∞—Ä–Ω–æ–π —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ (salient object/DIS).
- **birefnet-hrsod** ‚Äî –¥–ª—è –≤—ã—Å–æ–∫–æ–¥–µ—Ç–∞–ª—å–Ω—ã—Ö —Å—Ü–µ–Ω –∏ –æ–±—ä–µ–∫—Ç–æ–≤ –≤—ã—Å–æ–∫–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è.
- **birefnet-cod** ‚Äî –¥–ª—è —Å–∫—Ä—ã—Ç—ã—Ö/–º–∞–ª–æ–∑–∞–º–µ—Ç–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ (concealed object detection).
- **birefnet-massive** ‚Äî –æ–±—É—á–µ–Ω–∞ –Ω–∞ –±–æ–ª—å—à–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ, –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–º–µ—à–∞–Ω–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤.
- **bria-rmbg** ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å —Å –≤—ã—Å–æ–∫–∏–º –∫–∞—á–µ—Å—Ç–≤–æ–º, –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ —Å–ª–æ–∂–Ω—ã—Ö —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è—Ö.

---

## üíª –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- macOS Apple Silicon - CoreML
- Windows - CPU
- Linux - CPU

### –í–∏–¥–µ–æ –∏ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å

- –î–ª—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ–≥–æ —Ñ–æ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `webm` (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ alpha-–∫–∞–Ω–∞–ª–∞).
- –î–ª—è `mp4` –∑–∞–¥–∞–π—Ç–µ —Ü–≤–µ—Ç —Ñ–æ–Ω–∞ —á–µ—Ä–µ–∑ `--bg-color`.

---

## ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ë—ã—Å—Ç—Ä—ã–π smoke-—Ç–µ—Å—Ç CLI (—Å–∫—Ä–∏–ø—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `scripts/smoke_test.sh`):

```bash
./scripts/smoke_test.sh
```

–ê–≤—Ç–æ—Ç–µ—Å—Ç—ã (pytest):

```bash
pytest
```

–ï—Å–ª–∏ –Ω—É–∂–Ω—ã —Ç–æ–ª—å–∫–æ –±—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã –±–µ–∑ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö:

```bash
pytest -m "not slow"
```
